name: Self Test

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  security-review:
    if: github.event.pull_request.head.repo.full_name == github.repository
    uses: BeyondMachines/pr-bouncer/.github/workflows/security-review.yml@main
    with:
      risk_threshold: 7
      semgrep_rules: "p/security-audit,p/owasp-top-ten,p/python"
    secrets:
      GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}